---
description: 检测并报告代码中的潜在问题、错误
---

'软件开发需要多人协同'、'不同开发者具有不同的编码习惯和喜好'、'不同的喜好会增加项目的维护成本'、'每个项目或者团队需要明确统一的标准'

因此要形成规范尤其是前端，JS 的弱类型和动态类型,JS 的变量在声明时无需指定其类型。并且在其声明之后，可以为其随便赋值不同的类型。JS 由于不需要关注变量的类型，可以使代码更加简洁，也能使开发者集中更多的精力在处理业务逻辑之上。但由于其无法保证变量类型，从而在程序运行期可能发生跟类型相关的错误。 比如：

```js
var s = 1
s() //Uncaught TypeError: s is not a function
```

而这样的错误对于 JAVA 在编译期间就会检查出来。为了可以在编写中发现问题，前端出现了很多种尝试类似'TypeScript、CoffeeScript 或 Elm' 辅助工具出现了'Lint''Lint'工具最早是使用于 UNIX 系统中 C 语言的程式码静态分析工具，主要是用来标记语法结构上有可疑的、濳在的问题语法或指令,在前端类似的这种类似工具有'JSLint 与 JSHint',随着时代推移'ESLint'由 Nicholas C. Zakas 创造，正如是为 ES 新标准语法所设计,相比其他 js 检查工具来说'ESLint'的功能具有

- 有更多规则选项可以依需求或喜好设定
- 函式库或框架的开发者可以依需求再开发扩充
- 支持更高的 es 语法和实验特性和 JSX 语法
- 提供错误警告

正是因为 ESlint （使用 Node.js 编写） 需要将源码转为 AST 的特点并且还可以扩展规则，默认的解析器也能替换，这种自由度高可插拔的形式，最后'ESLint' 成为现阶段'js' 代码质量检查的工具

## 帮助解决问题

- '语言语法检查'：比如检查出字符串引号或者函数调用括号没有匹配等问题。
- '编码错误检查'：比如检查出开发者在使用一个不存在的变量或者变量定义了却没有使用等问题。
- '代码风格检查'：比如检查出开发者没有使用分号（与所选风格有关）等问题。

**注意他不会检查你 js api 调用的是否正确，明确他能做的**

## 安装使用

```bash
npm install eslint -D
```

通过 npx 可以产看'eslint' 版本

```bash
npx eslint --version
```

安装后开始使用：

初始化生成配置文件 `npx eslint --init` 初始化的时候会询问几个问题：

问题 1 ： 如何使用 ESLint ？
只检查语法错误 | 检测语法错误以及问题代码 | 检测语法错误以及问题代码以及代码风格

问题 2： 你的项目模块化选择类型？
JS modules(import/export) | CommonJS(require/exports) | None of these

问题 3：项目使用框架
问题 4： 是否使用 TS
问题 5： 运行环境 Browser | Node

问题 6: 定义代码风格
主流代码风格 | 个人自定义 | 根据代码判断

问题 7：配置文件格式 JS | YARM | JSON
问题 8： 安装额外的插件 Y

安装完成后会出现`.eslintrc.js` 文件,除了 `.eslintrc.js` 配置外还有其他配置文件的声明写法

- 'JavaScript' - 使用 .eslintrc.js 然后输出一个配置对象。
- 'YAML' - 使用 .eslintrc.yaml 或 .eslintrc.yml 去定义配置的结构。
- 'JSON' - 使用 .eslintrc.json 去定义配置的结构，ESLint 的 JSON 文件允许 JavaScript 风格的注释。
- 'package.json' - 在 package.json 里创建一个 eslintConfig 属性，在那里定义你的配置。

**优先级 '.eslintrc.js' > '.eslintrc.yaml' >'.eslintrc.yml' >'.eslintrc.json' >'.eslintrc'> 'package.json'**

也可以使用 eslintignore 忽略指定文件，对于一些公共的 js，或者测试脚本，不需要进行检测，我们可以通过在项目根目录创建一个`.eslintignore`告诉 ESLint 去忽略特定的目录或者文件

根据上面的询问选好配置后:

- 'npx eslint [文件路径]' -- 检查对应文件中编码格式。路径可以使用路径通配符
- 'npx eslint [文件路径] --fix' -- 自动修正代码风格

### eslint 检查指令 案例

```bash
# 检测单个文件
npx eslint file1.js file2.js
# 检测src和scripts目录
npx eslint src scripts
```

```js
var a = '1'
const zz = '1000'
```

检查对应文件中编码格式 给出了错误原因
![](/images/2023-08-14-23-28-31.png)

### 检查并修复 fix

`--fix后缀`，是 ESLint **提供自动修复基础错误的功能，它只能修复一些基础的不影响代码逻辑的错误，比如代码末尾加上分号、表达式的空格等等**。例如 `npx eslint src scripts --fix` / `npx eslint file1.js file2.js --fix`

案例

```js
    var a = '1'
    const zz = '1000'
```
修复后

~~~js
const a = '1';
const zz = '1000';
~~~
如图修复了格式问题 但并没有修复未引用问题

![](/images/2023-08-15-08-08-38.png)

### 指定文件ext

eslint 修复和检查都可以指定具体文件或者具体文件夹，**例如可以指定具体文件'aa.vue','aa.js',但是指定文件时候例如'/src' 这个文件下会有各种文件类型，但eslint 默认只会检测文件夹中的'js' 文件，此时需要使用'ext'**

注意只有在指定是文件夹时候使用'ext' 才会生效，举个例子`npx eslint --ext .js,.jsx,.vue src`

## eslintignore 忽略指定文件

对于一些公共的js，或者测试脚本，不需要进行检测，我们可以通过在项目根目录创建一个`.eslintignore`告诉ESLint去忽略特定的目录或者文件

~~~yaml
node_modules/
**/*.spec.*
**/style/
*.html
/components/test/*
es/
lib/
_site/
dist/
components/version/version.tsx

~~~

## 配置文件的字段说明
- `parser`: 解析器是ESLint用于将代码转换为抽象语法树（AST）的组件。ESLint默认使用的解析器是Espree，它能够将编写的代码解析成抽象语法树的形式，以便ESLint可以根据规则对代码进行验证和分析。

- `extends`: `extends`字段用于递归地扩展ESLint的配置。通过指定一个配置文件或一个可共享的配置名称，可以继承和重用其他配置。这样可以方便地在项目中共享和继承一组预定义的规则和配置，提高代码的一致性和可维护性。

- `rules`: `rules`字段用于定义ESLint的规则，它允许您自定义代码的静态分析规则。您可以为不同的规则指定不同的错误级别（如警告或错误）或禁用特定的规则。通过配置`rules`字段，您可以覆盖继承的配置或添加自定义规则，以满足项目的特定需求。

- `parserOptions`: `parserOptions`字段用于配置解析器的选项。您可以在这里指定解析器的版本、支持的ECMAScript版本、启用特定的语言特性（如模块化）等。解析器选项的配置可以影响ESLint在解析和分析代码时的行为。

- `plugins`: `plugins`字段用于为ESLint添加额外的检查规则。ESLint的核心规则集并不包含所有可能的规则，但通过使用插件，您可以扩展ESLint并使用来自插件的规则。插件可以提供特定领域的规则（如React或Vue.js），或者是一些通用的规则扩展。

- `env`: `env`字段用于定义一组预定义的全局变量，表示代码运行的环境。例如，如果您的代码将在浏览器环境中执行，您可以将`env`字段设置为`{ "browser": true }`，以便ESLint知道在分析代码时应该考虑浏览器全局变量。通过配置`env`字段，可以避免对未声明的变量和全局对象的使用进行警告或错误的检查。

### parser -- 解析器

想成为eslint 的parser解析器需要满足两点
* 它必须是一个 Node 模块，应该使用 npm 单独安装解析器包.
* 它必须符合 [parser interface](https://eslint.bootcss.com/docs/developer-guide/working-with-plugins#working-with-custom-parsers)


其他解析器：

   - `esprima`: ESLint最初使用的解析器，但后来不再维护。
   - `espree`: ESLint基于esprima v1.2.2开发的解析器，成为ESLint的默认解析器。
   - `babel-eslint`: 是对Babel解析器的封装，使其与ESLint兼容。
   - `@babel/eslint-parser`: 从v11.xx版本开始，`babel-eslint`不再维护和更新，取而代之的是`@babel/eslint-parser`。
   - `@typescript-eslint/parser`: 将TypeScript代码转换为与estree兼容的形式，以便在ESLint中使用。

解析器的选择：

   - 如果使用TypeScript，应选择`@typescript-eslint/parser`作为解析器。
   - 如果使用ES中的实验性属性，可以使用`babel`提供的解析器。
   - 若要支持最新的ES标准语法，可以使用ESLint默认的解析器。

解析器配置示例：

   - 配置示例（包含TypeScript解析器）：

     ```javascript
     module.exports = {
       parser: '@typescript-eslint/parser',
       // 其他配置项...
     };
     ```

   - 配置示例（使用babel解析器）：

     ```javascript
     module.exports = {
       parser: 'babel-eslint',
       // 其他配置项...
     };
     ```

   - 配置示例（不指定解析器，默认使用espree）：

     ```javascript
     module.exports = {
       // 其他配置项...
     };
     ```

针对Vue.js和TypeScript的配置：

   - 在Vue.js项目中结合TypeScript时，可以使用`@vue/eslint-config-typescript`扩展配置，它已经包含了TypeScript解析器和相关规则。
   - 可以参考以下示例配置：
     ```javascript
     module.exports = {
       root: true,
       'extends': [
         'plugin:vue/vue3-essential',
         'eslint:recommended',
         '@vue/eslint-config-typescript',
         '@vue/eslint-config-prettier/skip-formatting'
       ],
       parserOptions: {
         ecmaVersion: 'latest'
       },
       // 其他配置项...
     };
     ```

**根据具体需求和项目配置，选择合适的解析器和配置，以正确解析和检查代码。** [你使用@babel/eslint-parser 遇到了麻烦参考 Updating babel-eslint to @babel/eslint-parser for React apps](  https://tjaddison.com/blog/2021/03/updating-babel-eslint-to-babeleslint-parser-for-react-apps/)


### parserOptions -- 解析器选项
解析器选项用于配置解析器的行为，以便正确解析和分析代码。解析器选项的配置可以影响ESLint在解析和分析代码时的行为。

可以使用解析器选项覆盖该设置以启用对其他 ECMAScript 版本以及 JSX 的支持。简单理解配合你的解析器，之前说过默认的解析器是'espree'去gitub 搜索你可以发现当传入不同参数的时候配置器将会有不同的结果返回。

如果你正在尝试新的一些'ES'语法中的实验属性使用'babel' 提供的解析，当然如果你仅仅是想支持最新的最终 ES 标准可以使用eslint 默认以目前写文章的节点装饰器为例属于一个实验属性，在使用默认的eslint的解析器 是不行的，你需要使用'babel'

需要安装  解释一下'decorators' 装饰器目前在第二阶段因此需要下载'babel' 插件,关于配置

~~~bash
npm install @babel/core @babel/eslint-parser @babel/plugin-proposal-decorators  --save-dev
~~~

~~~js
        module.exports = {
        "parser":"@babel/eslint-parser",
        "env": {
            "browser": true,
            "es2021": true,
            "node": true
        },
        "extends": "eslint:recommended",
        // 相当于配置@babel/eslint-parser 解析器的配置
        parserOptions: {
            // 如果你 没有写 类似.babelrc 将需要requireConfigFile设置fasle
            // 表示不使用配置文件
            requireConfigFile: false,
            // 因为没有配置类似.babelrc 所以需要配置babelOptions声明使用的插件
            babelOptions: {
                plugins: [["@babel/plugin-proposal-decorators",{"legacy": true}]],
            }
        },
        "rules": {
        }
    };
~~~		
这个案例中如果你配置了类似'.babelrc' 文件那么你就可以不用配置'parserOptions' 这个参数


### plugins -- 插件

plugin插件主要是为eslint新增一些检查规则,ESLint 虽然可以定义很多的 rules，只是检查 JS 语法。如果需要检查 Vue 中的 template 或者 React 中的 jsx，就束手无策了。引入插件的目的就是为了增强 ESLint 的检查能力和范围简单的说像vue react 这类新的框架会有自己的规则，这类规则需要去安装额外的插件

在使用插件的用法上 插件名称可以省略 'eslint-plugin- 前缀'

~~~js
{
    "plugins": [
        "plugin1", // eslint-plugin-plugin1的简写
        "eslint-plugin-plugin2"
    ]
  }
~~~