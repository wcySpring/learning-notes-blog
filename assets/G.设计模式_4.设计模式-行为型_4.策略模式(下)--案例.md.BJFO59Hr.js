import{_ as s,c as n,o as a,a8 as l}from"./chunks/framework.6k5lawSO.js";const m=JSON.parse('{"title":"","description":"策略模式java  不同案例不同常见来进一步了解","frontmatter":{"description":"策略模式java  不同案例不同常见来进一步了解"},"headers":[],"relativePath":"G.设计模式/4.设计模式-行为型/4.策略模式(下)--案例.md","filePath":"G.设计模式/4.设计模式-行为型/4.策略模式(下)--案例.md","lastUpdated":1690900495000}'),p={name:"G.设计模式/4.设计模式-行为型/4.策略模式(下)--案例.md"},o=l(`<p>策略模式，重点是先找到能够进行策略划分的重点，然后将其一部分作为策略点进行分类，也不用非要强行去进行策略，在合理阶段时机进行就可以。</p><h2 id="java-案例一" tabindex="-1">java 案例一 <a class="header-anchor" href="#java-案例一" aria-label="Permalink to &quot;java 案例一&quot;">​</a></h2><p>在第一讲的时候使用 创建一个类的然后这类会收集职责和判断条作为绑定，来解决一些复杂判断情况，这个案例将使用将条件和职责维护一起</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> interface</span><span style="color:#C18401;"> TravelStrategy </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">    void</span><span style="color:#4078F2;"> travel</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">    boolean</span><span style="color:#4078F2;"> isSuitable</span><span style="color:#383A42;">(</span><span style="color:#C18401;">Condition</span><span style="color:#383A42;"> condition);</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// 判断条件的对象</span></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> Condition </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">    private</span><span style="color:#C18401;"> String</span><span style="color:#E45649;"> weather</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#A626A4;">    private</span><span style="color:#C18401;"> String</span><span style="color:#E45649;"> traffic</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#A626A4;">    private</span><span style="color:#A626A4;"> int</span><span style="color:#E45649;"> distance</span><span style="color:#383A42;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // getters and setters</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// 实现接口的策略</span></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> BikeTravelStrategy </span><span style="color:#A626A4;">implements</span><span style="color:#C18401;"> TravelStrategy </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#383A42;">    @</span><span style="color:#A626A4;">Override</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> void</span><span style="color:#4078F2;"> travel</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#E45649;">        System</span><span style="color:#383A42;">.</span><span style="color:#E45649;">out</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">println</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;Travel by bike.&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">    @</span><span style="color:#A626A4;">Override</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> boolean</span><span style="color:#4078F2;"> isSuitable</span><span style="color:#383A42;">(</span><span style="color:#C18401;">Condition</span><span style="color:#383A42;"> condition) {</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#50A14F;"> &quot;sunny&quot;</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">equals</span><span style="color:#383A42;">(</span><span style="color:#E45649;">condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">getWeather</span><span style="color:#383A42;">()) </span></span>
<span class="line"><span style="color:#383A42;">               &amp;&amp; </span><span style="color:#50A14F;">&quot;light&quot;</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">equals</span><span style="color:#383A42;">(</span><span style="color:#E45649;">condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">getTraffic</span><span style="color:#383A42;">()) </span></span>
<span class="line"><span style="color:#383A42;">               &amp;&amp; </span><span style="color:#E45649;">condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">getDistance</span><span style="color:#383A42;">() &lt; </span><span style="color:#986801;">5</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// implement \`isSuitable\` for other strategies in the same way</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// 上下文信息类（Context）</span></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> TravelContext </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">    private</span><span style="color:#C18401;"> List</span><span style="color:#E45649;">&lt;</span><span style="color:#C18401;">TravelStrategy</span><span style="color:#E45649;">&gt; strategies </span><span style="color:#383A42;">= </span><span style="color:#A626A4;">new</span><span style="color:#C18401;"> ArrayList</span><span style="color:#383A42;">&lt;&gt;();</span></span>
<span class="line"><span style="color:#A626A4;">    private</span><span style="color:#C18401;"> TravelStrategy</span><span style="color:#E45649;"> travelStrategy</span><span style="color:#383A42;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#4078F2;"> TravelContext</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#E45649;">        strategies</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> BikeTravelStrategy</span><span style="color:#383A42;">());</span></span>
<span class="line"><span style="color:#E45649;">        strategies</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> CarTravelStrategy</span><span style="color:#383A42;">());</span></span>
<span class="line"><span style="color:#E45649;">        strategies</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> WalkTravelStrategy</span><span style="color:#383A42;">());</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">		// 使用的时候先注入 判读条件根据条件选出符合的策略</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> void</span><span style="color:#4078F2;"> setCondition</span><span style="color:#383A42;">(</span><span style="color:#C18401;">Condition</span><span style="color:#383A42;"> condition) {</span></span>
<span class="line"><span style="color:#A626A4;">        for</span><span style="color:#383A42;"> (</span><span style="color:#C18401;">TravelStrategy</span><span style="color:#E45649;"> strategy </span><span style="color:#A626A4;">:</span><span style="color:#383A42;"> strategies) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;"> (</span><span style="color:#E45649;">strategy</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">isSuitable</span><span style="color:#383A42;">(condition)) {</span></span>
<span class="line"><span style="color:#383A42;">                travelStrategy = strategy;</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#A626A4;">        throw</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> IllegalArgumentException</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;No suitable strategy found for condition: &quot;</span><span style="color:#383A42;"> + condition);</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">		// 使用策略</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> void</span><span style="color:#4078F2;"> travel</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;"> (travelStrategy != </span><span style="color:#986801;">null</span><span style="color:#383A42;">) {</span></span>
<span class="line"><span style="color:#E45649;">            travelStrategy</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">travel</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#383A42;">        } </span><span style="color:#A626A4;">else</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">            throw</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> IllegalStateException</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;Travel strategy is not set.&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// 实际使用</span></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> Main </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> static</span><span style="color:#A626A4;"> void</span><span style="color:#4078F2;"> main</span><span style="color:#383A42;">(</span><span style="color:#C18401;">String</span><span style="color:#383A42;">[] args) {</span></span>
<span class="line"><span style="color:#C18401;">        TravelContext</span><span style="color:#E45649;"> travelContext </span><span style="color:#383A42;">= </span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> TravelContext</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#C18401;">        Condition</span><span style="color:#E45649;"> condition </span><span style="color:#383A42;">= </span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> Condition</span><span style="color:#383A42;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setWeather</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;sunny&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setTraffic</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;light&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setDistance</span><span style="color:#383A42;">(</span><span style="color:#986801;">3</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        travelContext</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setCondition</span><span style="color:#383A42;">(condition);</span></span>
<span class="line"><span style="color:#E45649;">        travelContext</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">travel</span><span style="color:#383A42;">();  </span><span style="color:#A0A1A7;font-style:italic;">// Output: Travel by bike.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setWeather</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;rainy&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setTraffic</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;heavy&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setDistance</span><span style="color:#383A42;">(</span><span style="color:#986801;">10</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        travelContext</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setCondition</span><span style="color:#383A42;">(condition);</span></span>
<span class="line"><span style="color:#E45649;">        travelContext</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">travel</span><span style="color:#383A42;">();  </span><span style="color:#A0A1A7;font-style:italic;">// Output: Travel by car.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setWeather</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;windy&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setTraffic</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&quot;light&quot;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        condition</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setDistance</span><span style="color:#383A42;">(</span><span style="color:#986801;">1</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#E45649;">        travelContext</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">setCondition</span><span style="color:#383A42;">(condition);</span></span>
<span class="line"><span style="color:#E45649;">        travelContext</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">travel</span><span style="color:#383A42;">();  </span><span style="color:#A0A1A7;font-style:italic;">// Output: Travel by walking.</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br></div></div><h2 id="java-案例二" tabindex="-1">java 案例二 <a class="header-anchor" href="#java-案例二" aria-label="Permalink to &quot;java 案例二&quot;">​</a></h2><p>现在 有三种组合状态组合对价格优惠，例如 第一个按钮是9 折 第二个按钮是 减10元 第三个按钮是 优惠20</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> interface</span><span style="color:#C18401;"> DiscountStrategy </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">    double</span><span style="color:#4078F2;"> apply</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">double</span><span style="color:#383A42;"> price);</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> DiscountNine </span><span style="color:#A626A4;">implements</span><span style="color:#C18401;"> DiscountStrategy </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#383A42;">    @</span><span style="color:#A626A4;">Override</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> double</span><span style="color:#4078F2;"> apply</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">double</span><span style="color:#383A42;"> price) {</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> price * </span><span style="color:#986801;">0.9</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> DiscountTen </span><span style="color:#A626A4;">implements</span><span style="color:#C18401;"> DiscountStrategy </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#383A42;">    @</span><span style="color:#A626A4;">Override</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> double</span><span style="color:#4078F2;"> apply</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">double</span><span style="color:#383A42;"> price) {</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> price - </span><span style="color:#986801;">10</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> DiscountTwenty </span><span style="color:#A626A4;">implements</span><span style="color:#C18401;"> DiscountStrategy </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#383A42;">    @</span><span style="color:#A626A4;">Override</span></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> double</span><span style="color:#4078F2;"> apply</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">double</span><span style="color:#383A42;"> price) {</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> price - </span><span style="color:#986801;">20</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> class</span><span style="color:#C18401;"> PriceCalculator </span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">    private</span><span style="color:#C18401;"> List</span><span style="color:#E45649;">&lt;</span><span style="color:#C18401;">DiscountStrategy</span><span style="color:#E45649;">&gt; strategies </span><span style="color:#383A42;">= </span><span style="color:#A626A4;">new</span><span style="color:#C18401;"> ArrayList</span><span style="color:#383A42;">&lt;&gt;();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> void</span><span style="color:#4078F2;"> addStrategy</span><span style="color:#383A42;">(</span><span style="color:#C18401;">DiscountStrategy</span><span style="color:#383A42;"> strategy) {</span></span>
<span class="line"><span style="color:#E45649;">        strategies</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(strategy);</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    public</span><span style="color:#A626A4;"> double</span><span style="color:#4078F2;"> calculate</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">double</span><span style="color:#383A42;"> price) {</span></span>
<span class="line"><span style="color:#A626A4;">        for</span><span style="color:#383A42;"> (</span><span style="color:#C18401;">DiscountStrategy</span><span style="color:#E45649;"> strategy </span><span style="color:#A626A4;">:</span><span style="color:#383A42;"> strategies) {</span></span>
<span class="line"><span style="color:#383A42;">            price = </span><span style="color:#E45649;">strategy</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">apply</span><span style="color:#383A42;">(price);</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> price;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// 使用</span></span>
<span class="line"><span style="color:#A626A4;">public</span><span style="color:#A626A4;"> static</span><span style="color:#A626A4;"> void</span><span style="color:#4078F2;"> main</span><span style="color:#383A42;">(</span><span style="color:#C18401;">String</span><span style="color:#383A42;">[] args) {</span></span>
<span class="line"><span style="color:#C18401;">    PriceCalculator</span><span style="color:#E45649;"> calculator </span><span style="color:#383A42;">= </span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> PriceCalculator</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#E45649;">    calculator</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">addStrategy</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> DiscountNine</span><span style="color:#383A42;">());</span></span>
<span class="line"><span style="color:#E45649;">    calculator</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">addStrategy</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">new</span><span style="color:#4078F2;"> DiscountTen</span><span style="color:#383A42;">());</span></span>
<span class="line"><span style="color:#E45649;">    System</span><span style="color:#383A42;">.</span><span style="color:#E45649;">out</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">println</span><span style="color:#383A42;">(</span><span style="color:#E45649;">calculator</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">calculate</span><span style="color:#383A42;">(</span><span style="color:#986801;">100</span><span style="color:#383A42;">));  </span><span style="color:#A0A1A7;font-style:italic;">// 输出: 71.0</span></span>
<span class="line"><span style="color:#383A42;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="js-案例一" tabindex="-1">js 案例一 <a class="header-anchor" href="#js-案例一" aria-label="Permalink to &quot;js 案例一&quot;">​</a></h2><p>上面同样的问题 js 的解决方法</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">meta</span><span style="color:#986801;"> charset</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;utf-8&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">form</span><span style="color:#986801;"> action</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;registerForm&quot;</span><span style="color:#986801;"> method</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;post&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入用户名：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入密码：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;passWord&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入手机号码：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;submit&quot;</span><span style="color:#986801;"> value</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;提交&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">form</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /***************策略对象*************/</span></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#986801;"> strategies</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#4078F2;">        isNotEmpty</span><span style="color:#383A42;">(value, errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value </span><span style="color:#0184BC;">===</span><span style="color:#50A14F;"> &#39;&#39;</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        minLength</span><span style="color:#383A42;">(value, length, errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value.</span><span style="color:#E45649;">length</span><span style="color:#0184BC;"> &lt;</span><span style="color:#383A42;"> length){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        isMobile</span><span style="color:#383A42;">(value, errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/(</span><span style="color:#A626A4;">^</span><span style="color:#0184BC;">1</span><span style="color:#986801;">[3|5|8][0-9]</span><span style="color:#0184BC;">{9}</span><span style="color:#A626A4;">$</span><span style="color:#0184BC;">)/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(value)){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /***************validator类***************/</span></span>
<span class="line"><span style="color:#A626A4;">    class</span><span style="color:#C18401;"> Validator</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">        constructor</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#E45649;">            this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> [];</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4078F2;">        add</span><span style="color:#383A42;">(dom, rules) {</span></span>
<span class="line"><span style="color:#A626A4;">            for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">let</span><span style="color:#383A42;"> i </span><span style="color:#0184BC;">=</span><span style="color:#986801;"> 0</span><span style="color:#383A42;">; i </span><span style="color:#0184BC;">&lt;</span><span style="color:#383A42;"> rules.</span><span style="color:#E45649;">length</span><span style="color:#383A42;">; i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">) {</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> rule </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rules[i];</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> strategyAry </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#E45649;">strategy</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">split</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;:&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#E45649;">errorMsg</span><span style="color:#383A42;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E45649;">                this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(() </span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">                    let</span><span style="color:#383A42;"> strategy </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> strategyAry.</span><span style="color:#4078F2;">shift</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#383A42;">                    strategyAry.</span><span style="color:#4078F2;">unshift</span><span style="color:#383A42;">(dom.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">                    strategyAry.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(errorMsg);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">                    return</span><span style="color:#383A42;"> strategies[strategy].</span><span style="color:#4078F2;">apply</span><span style="color:#383A42;">(dom, strategyAry);</span></span>
<span class="line"><span style="color:#383A42;">                });</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4078F2;">        start</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#A626A4;">            for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">let</span><span style="color:#383A42;"> i </span><span style="color:#0184BC;">=</span><span style="color:#986801;"> 0</span><span style="color:#383A42;">; i </span><span style="color:#0184BC;">&lt;</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#E45649;">length</span><span style="color:#383A42;">; i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">) {</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> validatorFunc </span><span style="color:#0184BC;">=</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">[i];</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">                if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#A626A4;">                    return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">                }</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /************客户调用代码***********/</span></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#986801;"> registerForm</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;registerForm&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> () </span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">        const</span><span style="color:#986801;"> validator</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> Validator</span><span style="color:#383A42;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">userName</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;isNotEmpty&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户名不能为空&#39;</span></span>
<span class="line"><span style="color:#383A42;">        },{</span><span style="color:#E45649;">strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;minLength:10&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户名长度不能小于10位&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">passWord</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;minLength:6&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户密码不能小于6位&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">phoneNumber</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;isMobile&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;手机号码格式不正确&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">        const</span><span style="color:#986801;"> errorMsg</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> validator.</span><span style="color:#4078F2;">start</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">    registerForm.</span><span style="color:#4078F2;">onsubmit</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> () </span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">        const</span><span style="color:#986801;"> errorMsg</span><span style="color:#0184BC;"> =</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(errorMsg);</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br></div></div><h2 id="js-案例二" tabindex="-1">js 案例二 <a class="header-anchor" href="#js-案例二" aria-label="Permalink to &quot;js 案例二&quot;">​</a></h2><p>表单验证，通过if else来进行判断验证，后期会维护大量的if - else的逻辑验证</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">form</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&#39;login-form&#39;</span><span style="color:#986801;"> action</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;&quot;</span><span style="color:#986801;"> method</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;post&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">&gt;用户名&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">&gt;手机号&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;number&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#383A42;">&gt;密码&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">button</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&#39;login&#39;</span><span style="color:#383A42;">&gt;登录&lt;/</span><span style="color:#E45649;">button</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">form</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#383A42;"> loginForm </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;login-form&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">    loginForm.</span><span style="color:#4078F2;">onsubmit</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> () {</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(loginForm.</span><span style="color:#E45649;">userName</span><span style="color:#383A42;">.</span><span style="color:#E45649;">value</span><span style="color:#0184BC;"> ===</span><span style="color:#50A14F;">&#39;&#39;</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;用户名不能为空&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(loginForm.</span><span style="color:#E45649;">password</span><span style="color:#383A42;">.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">.</span><span style="color:#E45649;">length</span><span style="color:#0184BC;">&lt;</span><span style="color:#986801;">6</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;密码长度不能小于六位&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;"> (</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/(</span><span style="color:#A626A4;">^</span><span style="color:#0184BC;">1</span><span style="color:#986801;">[3|4|5|7|8][0-9]</span><span style="color:#0184BC;">{9}</span><span style="color:#A626A4;">$</span><span style="color:#0184BC;">)/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(loginForm.</span><span style="color:#E45649;">phoneNumber</span><span style="color:#383A42;">.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">)) {</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;手机号格式错误&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li><strong>利用策略模式要将代码拆成两个两部分</strong>，第一个部分&#39;封装不同策略的策略组&#39;，也就是要将这些验证对象封装成策略对象，第二部分需要&#39;Context&#39;执行这些策略的调用，调用策略对象</li></ul><p>第一部分要封装的策略组代码，也就是上面的if else，都需要被判断参数，报错信息。其中判断长度比较特别需要，一个额外的长度来控制各种长度出现的情况</p><p>二部分也就是一个&#39;执行这些策略的调用&#39;，构想就是分成两部分，第一部分就是添加你想要的策略，第二部分就是统一执行你添加的策略</p><p>根据上面分析，整个负责验证的策略对象中的每个策略，最少需要两个参数，第一个参数就是要验证的值，第二个参数就是验证后的报错提示信息。除了特殊策略，例如长度验证需要一个关于长度的判断值</p><ul><li><strong>es5 版本</strong></li></ul><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">&lt;!</span><span style="color:#E45649;">DOCTYPE</span><span style="color:#986801;"> html</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">html</span><span style="color:#986801;"> lang</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;en&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">meta</span><span style="color:#986801;"> charset</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;UTF-8&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">title</span><span style="color:#383A42;">&gt;Title&lt;/</span><span style="color:#E45649;">title</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">form</span><span style="color:#986801;">  id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;registerForm&quot;</span><span style="color:#986801;"> method</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;post&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">&gt;用户名&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">&gt;手机号&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;number&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#383A42;">&gt;密码&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">        &lt;</span><span style="color:#E45649;">button</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&#39;login&#39;</span><span style="color:#383A42;">&gt;登录&lt;/</span><span style="color:#E45649;">button</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;/</span><span style="color:#E45649;">form</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /**</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     * 策略模式的两个点</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     * 1.存所有的验证（策略）</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     * 2.有一个可以调用所有验证（执行策略）</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     * 策略模式执行的类：</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     * 3.有一个方法这个方法是专门又来存这些验证的，存这些验证需要什么</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *  3.1 需要一个能存的变量 因为要存多个这个变量选数组</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *  3.2 要存的是什么，这里要存的是错误提示</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *      3.2.1 要存错误提示怎么存是进来一个就调用把错误提示存进这个变量？</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *            还是说存这些方法，在最后执行的时候调用这些方法比较好</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *            这里选用后者存这些验证方法</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *  3.3 能存了核心在哪，在策略模式最后需要有个执行者，执行这些策略，也就是</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *      这个类需要一个执行方法start</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     *  4.要细分存储策略的add方法的具体参数，需要有一个要验证的对象，需要有验证的规则，需要有验证的提示</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">     * **/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 策略对象</span></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#986801;"> strategies</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#4078F2;">        isNonEmpty</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> (value, errorMsg) { </span><span style="color:#A0A1A7;font-style:italic;">// 不能为空，第一个参数要验证的值，第二个是提示</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value </span><span style="color:#0184BC;">===</span><span style="color:#50A14F;"> &#39;&#39;</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        minLength</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;"> (value, length,errorMsg) { </span><span style="color:#A0A1A7;font-style:italic;">// 最小长度</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value.</span><span style="color:#E45649;">length</span><span style="color:#0184BC;"> &lt;</span><span style="color:#383A42;"> length){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        isMobile</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;"> (value,errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;"> (</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/(</span><span style="color:#A626A4;">^</span><span style="color:#0184BC;">1</span><span style="color:#986801;">[3|4|5|7|8][0-9]</span><span style="color:#0184BC;">{9}</span><span style="color:#A626A4;">$</span><span style="color:#0184BC;">)/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(value)) { </span><span style="color:#A0A1A7;font-style:italic;">// 验证电话号码</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 委托来让 Context 拥有执行策略的能力Validator</span></span>
<span class="line"><span style="color:#A626A4;">    function</span><span style="color:#4078F2;"> Validator</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 对应第三条的分析</span></span>
<span class="line"><span style="color:#E45649;">        this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> []</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 关于参数对照第四条</span></span>
<span class="line"><span style="color:#C18401;">    Validator</span><span style="color:#383A42;">.</span><span style="color:#E45649;">prototype</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">add</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> (dom,rule,errorMsg) {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 规则针对要传入自己额外规则参数的验证 我们规定用&#39;:&#39; 分开</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 因此需要对规则在进行拆分</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> ary </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#4078F2;">split</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;:&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 对规则进一步的验证发方法存放在this.cache中</span></span>
<span class="line"><span style="color:#E45649;">        this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">function</span><span style="color:#383A42;"> () {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">            // 验证规则</span></span>
<span class="line"><span style="color:#A626A4;">            var</span><span style="color:#383A42;"> strategy </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> ary.</span><span style="color:#4078F2;">shift</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">            // 分析我么的策略中最特殊需要参数的方法function (value, length,errorMsg)</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">            // 经过上一步的操作 ary 中只能有两种情况，一种是空数组，一种是有一个自己定义的验证判断规则参数</span></span>
<span class="line"><span style="color:#383A42;">            ary.</span><span style="color:#4078F2;">unshift</span><span style="color:#383A42;">(dom.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#383A42;">            ary.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(errorMsg)</span></span>
<span class="line"><span style="color:#383A42;">            console.</span><span style="color:#4078F2;">log</span><span style="color:#383A42;">(strategy)</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#383A42;"> strategies[strategy].</span><span style="color:#4078F2;">apply</span><span style="color:#383A42;">(dom,ary)</span></span>
<span class="line"><span style="color:#383A42;">        })</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 最后调用策略的方法</span></span>
<span class="line"><span style="color:#C18401;">    Validator</span><span style="color:#383A42;">.</span><span style="color:#E45649;">prototype</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">start</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> () {</span></span>
<span class="line"><span style="color:#A626A4;">        for</span><span style="color:#383A42;"> (</span><span style="color:#A626A4;">var</span><span style="color:#383A42;"> i</span><span style="color:#0184BC;">=</span><span style="color:#986801;">0</span><span style="color:#383A42;">,validatorFunc;validatorFunc </span><span style="color:#0184BC;">=</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">[i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">];){</span></span>
<span class="line"><span style="color:#A626A4;">            var</span><span style="color:#383A42;"> msg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(msg){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> msg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#383A42;"> registerForm </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;registerForm&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#4078F2;"> validataFun</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> () {</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> validator </span><span style="color:#0184BC;">=</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> Validator</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">userName</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;isNonEmpty&#39;</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;用户名不能为空&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">password</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;minLength:6&#39;</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;密码长度不能少于六位&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">phoneNumber</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;isMobile&#39;</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;手机格式不正确&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> validator.</span><span style="color:#4078F2;">start</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">    registerForm.</span><span style="color:#4078F2;">onsubmit</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> (e) {</span></span>
<span class="line"><span style="color:#383A42;">                e.</span><span style="color:#4078F2;">preventDefault</span><span style="color:#383A42;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validataFun</span><span style="color:#383A42;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(errorMsg)</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span><span style="color:#A0A1A7;font-style:italic;"> // 组织表单提交</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br></div></div><ul><li><strong>es6 思路</strong></li></ul><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">&lt;!</span><span style="color:#E45649;">DOCTYPE</span><span style="color:#986801;"> html</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">html</span><span style="color:#986801;"> lang</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;en&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">meta</span><span style="color:#986801;"> charset</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;UTF-8&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">title</span><span style="color:#383A42;">&gt;Title&lt;/</span><span style="color:#E45649;">title</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">&gt;用户名&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">&gt;手机号&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;number&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">label</span><span style="color:#986801;"> for</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#383A42;">&gt;密码&lt;/</span><span style="color:#E45649;">label</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;password&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">button</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&#39;login&#39;</span><span style="color:#383A42;">&gt;登录&lt;/</span><span style="color:#E45649;">button</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 策略对象</span></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#986801;"> strategies</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#4078F2;">        isNonEmpty</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> (value, errorMsg) { </span><span style="color:#A0A1A7;font-style:italic;">// 不能为空，第一个参数要验证的值，第二个是提示</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value </span><span style="color:#0184BC;">===</span><span style="color:#50A14F;"> &#39;&#39;</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        minLength</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;"> (value, length,errorMsg) { </span><span style="color:#A0A1A7;font-style:italic;">// 最小长度</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value.</span><span style="color:#E45649;">length</span><span style="color:#0184BC;"> &lt;</span><span style="color:#383A42;"> length){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        isMobile</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;"> (value,errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;"> (</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/(</span><span style="color:#A626A4;">^</span><span style="color:#0184BC;">1</span><span style="color:#986801;">[3|4|5|7|8][0-9]</span><span style="color:#0184BC;">{9}</span><span style="color:#A626A4;">$</span><span style="color:#0184BC;">)/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(value)) { </span><span style="color:#A0A1A7;font-style:italic;">// 验证电话号码</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 执行这些策略的调用的类Validator -- 这里直接es6 写法</span></span>
<span class="line"><span style="color:#A626A4;">    class</span><span style="color:#C18401;"> Validator</span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">        constructor</span><span style="color:#383A42;">(strategies){</span></span>
<span class="line"><span style="color:#E45649;">            this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> []</span></span>
<span class="line"><span style="color:#E45649;">            this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">strategies</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> strategies </span><span style="color:#A0A1A7;font-style:italic;">// 策略对象</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 保存所有验证方法</span></span>
<span class="line"><span style="color:#4078F2;">        add</span><span style="color:#383A42;">(value, rule, errorMsg){</span></span>
<span class="line"><span style="color:#A626A4;">            let</span><span style="color:#383A42;"> ary </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#4078F2;">split</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;:&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#E45649;">            this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(()</span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> strategy </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> ary.</span><span style="color:#4078F2;">shift</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#383A42;">                ary.</span><span style="color:#4078F2;">unshift</span><span style="color:#383A42;">(value)</span></span>
<span class="line"><span style="color:#383A42;">                ary.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(errorMsg)</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">                // 当想给函数传多个参数利用数组的形式的话es5 首先考虑利用apply</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">                // es6 理解结构赋值的方法this.strategies[strategy](...ary)</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">strategies</span><span style="color:#383A42;">[strategy].</span><span style="color:#4078F2;">apply</span><span style="color:#383A42;">(</span><span style="color:#E45649;">this</span><span style="color:#383A42;">,ary)</span></span>
<span class="line"><span style="color:#383A42;">            })</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 统一执行调用</span></span>
<span class="line"><span style="color:#4078F2;">        start</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#A626A4;">            let</span><span style="color:#383A42;"> msg </span><span style="color:#0184BC;">=</span><span style="color:#50A14F;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#A626A4;">            for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">let</span><span style="color:#383A42;"> item </span><span style="color:#A626A4;">of</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#383A42;">                msg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> item</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#A626A4;">                if</span><span style="color:#383A42;">(msg){</span></span>
<span class="line"><span style="color:#A626A4;">                    return</span><span style="color:#383A42;"> msg</span></span>
<span class="line"><span style="color:#383A42;">                }</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    let</span><span style="color:#383A42;"> userName </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;userName&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#A626A4;">    let</span><span style="color:#383A42;"> password </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;password&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#A626A4;">    let</span><span style="color:#383A42;"> phoneNumber </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;phoneNumber&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    // 每次执行调用为了获取最新的输入value值</span></span>
<span class="line"><span style="color:#A626A4;">    let</span><span style="color:#4078F2;"> validataFun</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;"> () {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">        // 创建一个&#39;执行这些策略的调用&#39; 的Validator实例</span></span>
<span class="line"><span style="color:#A626A4;">        let</span><span style="color:#383A42;"> validator </span><span style="color:#0184BC;">=</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> Validator</span><span style="color:#383A42;">(strategies)</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(userName.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;isNonEmpty&#39;</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;用户名不能为空&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(password.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;minLength:6&#39;</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;密码长度不能少于六位&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(phoneNumber.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;isMobile&#39;</span><span style="color:#383A42;">,</span><span style="color:#50A14F;">&#39;手机格式不正确&#39;</span><span style="color:#383A42;">)</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> validator.</span><span style="color:#4078F2;">start</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> errorMsg</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">    document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;login&#39;</span><span style="color:#383A42;">).</span><span style="color:#4078F2;">onclick</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> ()</span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#A626A4;">       let</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validataFun</span><span style="color:#383A42;">()</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(errorMsg)</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br></div></div><p><strong>上面是单个验证 如果多个验证验证代码解决思路</strong></p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">meta</span><span style="color:#986801;"> charset</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;utf-8&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">form</span><span style="color:#986801;"> action</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;registerForm&quot;</span><span style="color:#986801;"> method</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;post&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入用户名：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入密码：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;passWord&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入手机号码：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;submit&quot;</span><span style="color:#986801;"> value</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;提交&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">form</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /***************策略对象*************/</span></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#383A42;"> strategies </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#4078F2;">        isNotEmpty</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;">(value,errorMsg){</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value </span><span style="color:#0184BC;">===</span><span style="color:#50A14F;"> &#39;&#39;</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        minLength</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;">(value,length,errorMsg){</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value.</span><span style="color:#E45649;">length</span><span style="color:#0184BC;">&lt;</span><span style="color:#383A42;">length){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        isMobile</span><span style="color:#0184BC;">:</span><span style="color:#A626A4;">function</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/(</span><span style="color:#A626A4;">^</span><span style="color:#0184BC;">1</span><span style="color:#986801;">[3|5|8][0-9]</span><span style="color:#0184BC;">{9}</span><span style="color:#A626A4;">$</span><span style="color:#0184BC;">)/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(value)){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /***************validator类***************/</span></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#4078F2;">  Validator</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#E45649;">        this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> [];</span></span>
<span class="line"><span style="color:#383A42;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C18401;">    Validator</span><span style="color:#383A42;">.</span><span style="color:#E45649;">prototype</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">add</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;">(dom,rules){</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> self </span><span style="color:#0184BC;">=</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">        for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">var</span><span style="color:#383A42;"> i</span><span style="color:#0184BC;">=</span><span style="color:#986801;">0</span><span style="color:#383A42;">,rule;rule </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rules[i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">];){</span></span>
<span class="line"><span style="color:#383A42;">            (</span><span style="color:#A626A4;">function</span><span style="color:#383A42;">(rule){</span></span>
<span class="line"><span style="color:#A626A4;">                var</span><span style="color:#383A42;"> strategyAry </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#E45649;">strategy</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">split</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;:&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#A626A4;">                var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#E45649;">errorMsg</span><span style="color:#383A42;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">                self.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">function</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#A626A4;">                    var</span><span style="color:#383A42;"> strategy </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> strategyAry.</span><span style="color:#4078F2;">shift</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#383A42;">                    strategyAry.</span><span style="color:#4078F2;">unshift</span><span style="color:#383A42;">(dom.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">                    strategyAry.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(errorMsg);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">                    return</span><span style="color:#383A42;"> strategies[strategy].</span><span style="color:#4078F2;">apply</span><span style="color:#383A42;">(dom,strategyAry);</span></span>
<span class="line"><span style="color:#383A42;">                })</span></span>
<span class="line"><span style="color:#383A42;">            })(rule);</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#C18401;">    Validator</span><span style="color:#383A42;">.</span><span style="color:#E45649;">prototype</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">start</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#A626A4;">        for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">var</span><span style="color:#383A42;"> i</span><span style="color:#0184BC;">=</span><span style="color:#986801;">0</span><span style="color:#383A42;">,validatorFunc;validatorFunc </span><span style="color:#0184BC;">=</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">[i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">];){</span></span>
<span class="line"><span style="color:#A626A4;">            var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /************客户调用代码***********/</span></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#383A42;"> registerForm </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;registerForm&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    var</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> validator </span><span style="color:#0184BC;">=</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> Validator</span><span style="color:#383A42;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">userName</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;isNotEmpty&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户名不能为空&#39;</span></span>
<span class="line"><span style="color:#383A42;">        },{</span><span style="color:#E45649;">strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;minLength:10&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户名长度不能小于10位&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">passWord</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;minLength:6&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户密码不能小于6位&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">phoneNumber</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;isMobile&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;手机号码格式不正确&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> validator.</span><span style="color:#4078F2;">start</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">    registerForm.</span><span style="color:#4078F2;">onsubmit</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> function</span><span style="color:#383A42;">(){</span></span>
<span class="line"><span style="color:#A626A4;">        var</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(errorMsg);</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br></div></div><p><strong>es6 写法</strong></p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">meta</span><span style="color:#986801;"> charset</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;utf-8&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">head</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">form</span><span style="color:#986801;"> action</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;&quot;</span><span style="color:#986801;"> id</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;registerForm&quot;</span><span style="color:#986801;"> method</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;post&quot;</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入用户名：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;userName&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入密码：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;passWord&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    请输入手机号码：&lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;text&quot;</span><span style="color:#986801;"> name</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;phoneNumber&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">    &lt;</span><span style="color:#E45649;">input</span><span style="color:#986801;"> type</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;submit&quot;</span><span style="color:#986801;"> value</span><span style="color:#383A42;">=</span><span style="color:#50A14F;">&quot;提交&quot;</span><span style="color:#383A42;">/&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">form</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /***************策略对象*************/</span></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#986801;"> strategies</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#4078F2;">        isNotEmpty</span><span style="color:#383A42;">(value, errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value </span><span style="color:#0184BC;">===</span><span style="color:#50A14F;"> &#39;&#39;</span><span style="color:#383A42;">){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        minLength</span><span style="color:#383A42;">(value, length, errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(value.</span><span style="color:#E45649;">length</span><span style="color:#0184BC;"> &lt;</span><span style="color:#383A42;"> length){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        },</span></span>
<span class="line"><span style="color:#4078F2;">        isMobile</span><span style="color:#383A42;">(value, errorMsg) {</span></span>
<span class="line"><span style="color:#A626A4;">            if</span><span style="color:#383A42;">(</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/(</span><span style="color:#A626A4;">^</span><span style="color:#0184BC;">1</span><span style="color:#986801;">[3|5|8][0-9]</span><span style="color:#0184BC;">{9}</span><span style="color:#A626A4;">$</span><span style="color:#0184BC;">)/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(value)){</span></span>
<span class="line"><span style="color:#A626A4;">                return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /***************validator类***************/</span></span>
<span class="line"><span style="color:#A626A4;">    class</span><span style="color:#C18401;"> Validator</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">        constructor</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#E45649;">            this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> [];</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4078F2;">        add</span><span style="color:#383A42;">(dom, rules) {</span></span>
<span class="line"><span style="color:#A626A4;">            for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">let</span><span style="color:#383A42;"> i </span><span style="color:#0184BC;">=</span><span style="color:#986801;"> 0</span><span style="color:#383A42;">; i </span><span style="color:#0184BC;">&lt;</span><span style="color:#383A42;"> rules.</span><span style="color:#E45649;">length</span><span style="color:#383A42;">; i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">) {</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> rule </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rules[i];</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> strategyAry </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#E45649;">strategy</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">split</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;:&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> rule.</span><span style="color:#E45649;">errorMsg</span><span style="color:#383A42;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E45649;">                this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(() </span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">                    let</span><span style="color:#383A42;"> strategy </span><span style="color:#0184BC;">=</span><span style="color:#383A42;"> strategyAry.</span><span style="color:#4078F2;">shift</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#383A42;">                    strategyAry.</span><span style="color:#4078F2;">unshift</span><span style="color:#383A42;">(dom.</span><span style="color:#E45649;">value</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">                    strategyAry.</span><span style="color:#4078F2;">push</span><span style="color:#383A42;">(errorMsg);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">                    return</span><span style="color:#383A42;"> strategies[strategy].</span><span style="color:#4078F2;">apply</span><span style="color:#383A42;">(dom, strategyAry);</span></span>
<span class="line"><span style="color:#383A42;">                });</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4078F2;">        start</span><span style="color:#383A42;">() {</span></span>
<span class="line"><span style="color:#A626A4;">            for</span><span style="color:#383A42;">(</span><span style="color:#A626A4;">let</span><span style="color:#383A42;"> i </span><span style="color:#0184BC;">=</span><span style="color:#986801;"> 0</span><span style="color:#383A42;">; i </span><span style="color:#0184BC;">&lt;</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">.</span><span style="color:#E45649;">length</span><span style="color:#383A42;">; i</span><span style="color:#0184BC;">++</span><span style="color:#383A42;">) {</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> validatorFunc </span><span style="color:#0184BC;">=</span><span style="color:#E45649;"> this</span><span style="color:#383A42;">.</span><span style="color:#E45649;">cache</span><span style="color:#383A42;">[i];</span></span>
<span class="line"><span style="color:#A626A4;">                let</span><span style="color:#383A42;"> errorMsg </span><span style="color:#0184BC;">=</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">                if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#A626A4;">                    return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">                }</span></span>
<span class="line"><span style="color:#383A42;">            }</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">    /************客户调用代码***********/</span></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#986801;"> registerForm</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> document.</span><span style="color:#4078F2;">getElementById</span><span style="color:#383A42;">(</span><span style="color:#50A14F;">&#39;registerForm&#39;</span><span style="color:#383A42;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">    const</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> () </span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">        const</span><span style="color:#986801;"> validator</span><span style="color:#0184BC;"> =</span><span style="color:#A626A4;"> new</span><span style="color:#4078F2;"> Validator</span><span style="color:#383A42;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">userName</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;isNotEmpty&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户名不能为空&#39;</span></span>
<span class="line"><span style="color:#383A42;">        },{</span><span style="color:#E45649;">strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;minLength:10&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户名长度不能小于10位&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">passWord</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;minLength:6&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;用户密码不能小于6位&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"><span style="color:#383A42;">        validator.</span><span style="color:#4078F2;">add</span><span style="color:#383A42;">(registerForm.</span><span style="color:#E45649;">phoneNumber</span><span style="color:#383A42;">,[{</span></span>
<span class="line"><span style="color:#E45649;">            strategy</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;isMobile&#39;</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#E45649;">            errorMsg</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;">&#39;手机号码格式不正确&#39;</span></span>
<span class="line"><span style="color:#383A42;">        }]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;">        const</span><span style="color:#986801;"> errorMsg</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> validator.</span><span style="color:#4078F2;">start</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">        return</span><span style="color:#383A42;"> errorMsg;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;">    registerForm.</span><span style="color:#4078F2;">onsubmit</span><span style="color:#0184BC;"> =</span><span style="color:#383A42;"> () </span><span style="color:#A626A4;">=&gt;</span><span style="color:#383A42;"> {</span></span>
<span class="line"><span style="color:#A626A4;">        const</span><span style="color:#986801;"> errorMsg</span><span style="color:#0184BC;"> =</span><span style="color:#4078F2;"> validatorFunc</span><span style="color:#383A42;">();</span></span>
<span class="line"><span style="color:#A626A4;">        if</span><span style="color:#383A42;">(errorMsg){</span></span>
<span class="line"><span style="color:#4078F2;">            alert</span><span style="color:#383A42;">(errorMsg);</span></span>
<span class="line"><span style="color:#A626A4;">            return</span><span style="color:#986801;"> false</span><span style="color:#383A42;">;</span></span>
<span class="line"><span style="color:#383A42;">        }</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">script</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">body</span><span style="color:#383A42;">&gt;</span></span>
<span class="line"><span style="color:#383A42;">&lt;/</span><span style="color:#E45649;">html</span><span style="color:#383A42;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br></div></div>`,25),e=[o];function r(c,t,y,i,A,b){return a(),n("div",null,e)}const g=s(p,[["render",r]]);export{m as __pageData,g as default};
