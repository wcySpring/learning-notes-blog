import{_ as s,c as n,o as a,a8 as p}from"./chunks/framework.6k5lawSO.js";const b=JSON.parse('{"title":"","description":"限制项目使用的工具","frontmatter":{"description":"限制项目使用的工具"},"headers":[],"relativePath":"H.各种练习项目/Vue3项目搭建/10.项目中的各种小工具/限制项目只能使用pnpm.md","filePath":"H.各种练习项目/Vue3项目搭建/10.项目中的各种小工具/限制项目只能使用pnpm.md","lastUpdated":1695881925000}'),l={name:"H.各种练习项目/Vue3项目搭建/10.项目中的各种小工具/限制项目只能使用pnpm.md"},e=p(`<p>如果你想限制统一团队使用的包管理工具，可以创建校验脚本，创建文件 <code>scripts/preinstall.js</code>,编写代码</p><p><code>process.env.npm_execpath</code> 是一个 Node.js 环境变量，它包含了执行 npm（或兼容的包管理工具，如 yarn、pnpm 等）命令时的完整路径。这个环境变量在 npm 的生命周期脚本（如 preinstall、install、postinstall 等）中可用。</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#A626A4;">if</span><span style="color:#383A42;"> (</span><span style="color:#0184BC;">!</span><span style="color:#0184BC;">/pnpm/</span><span style="color:#383A42;">.</span><span style="color:#4078F2;">test</span><span style="color:#383A42;">(process.</span><span style="color:#E45649;">env</span><span style="color:#383A42;">.</span><span style="color:#E45649;">npm_execpath</span><span style="color:#0184BC;"> ||</span><span style="color:#50A14F;"> &#39;&#39;</span><span style="color:#383A42;">)) {</span></span>
<span class="line"><span style="color:#383A42;">  console.</span><span style="color:#4078F2;">warn</span><span style="color:#383A42;">(</span></span>
<span class="line"><span style="color:#50A14F;">    \`</span><span style="color:#0184BC;">\\u001b</span><span style="color:#50A14F;">[33mThis repository must using pnpm as the package manager \`</span><span style="color:#0184BC;"> +</span></span>
<span class="line"><span style="color:#50A14F;">      \` for scripts to work properly.</span><span style="color:#0184BC;">\\u001b</span><span style="color:#50A14F;">[39m</span><span style="color:#0184BC;">\\n</span><span style="color:#50A14F;">\`</span><span style="color:#383A42;">,</span></span>
<span class="line"><span style="color:#383A42;">  );</span></span>
<span class="line"><span style="color:#383A42;">  process.</span><span style="color:#4078F2;">exit</span><span style="color:#383A42;">(</span><span style="color:#986801;">1</span><span style="color:#383A42;">);</span></span>
<span class="line"><span style="color:#383A42;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// if (/yarn/.test(process.env.npm_execpath || &#39;&#39;)) {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">//   // 执行适用于 yarn 的代码</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// } else if (/npm/.test(process.env.npm_execpath || &#39;&#39;)) {</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">//   // 执行适用于 npm 的代码</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;">// }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>在package.json 使用脚本指令， <code>preinstall</code> 是一个在 Node.js 的 npm（或其他兼容的包管理工具，如 yarn、pnpm 等）生命周期脚本中使用的钩子。当你运行 <code>npm install</code> 或者在项目中添加一个新的依赖时， <code>preinstall</code> 脚本会在实际安装依赖之前执行</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#50A14F;">&quot;scripts&quot;</span><span style="color:#383A42;">: {</span></span>
<span class="line"><span style="color:#50A14F;">    &quot;preinstall&quot;</span><span style="color:#0184BC;">:</span><span style="color:#50A14F;"> &quot;node ./scripts/preinstall.js&quot;</span></span>
<span class="line"><span style="color:#383A42;">  },</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="pnpm-自带检查指令" tabindex="-1">pnpm 自带检查指令 <a class="header-anchor" href="#pnpm-自带检查指令" aria-label="Permalink to &quot;pnpm 自带检查指令&quot;">​</a></h2><p>当您在项目中使用 pnpm 时，为了防止开发人员使用其他包管理器，可以在 package.json 中添加以下预安装脚本 <a href="https://pnpm.io/only-allow-pnpm" target="_blank" rel="noreferrer">Only allow pnpm</a></p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki one-light vp-code" tabindex="0"><code><span class="line"><span style="color:#383A42;">{</span></span>
<span class="line"><span style="color:#E45649;">    &quot;scripts&quot;</span><span style="color:#383A42;">: {</span></span>
<span class="line"><span style="color:#E45649;">        &quot;preinstall&quot;</span><span style="color:#383A42;">: </span><span style="color:#50A14F;">&quot;npx only-allow pnpm&quot;</span></span>
<span class="line"><span style="color:#383A42;">    }</span></span>
<span class="line"><span style="color:#383A42;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,8),o=[e];function t(r,c,i,y,m,d){return a(),n("div",null,o)}const A=s(l,[["render",t]]);export{b as __pageData,A as default};
